from google.generativeai.types import FunctionDeclaration, Tool


# Определение инструмента для получения всех услуг
get_all_services_declaration = FunctionDeclaration(
    name="get_all_services",
    description=(
        "Получает полный список всех доступных услуг салона красоты. "
        "Используй эту функцию, когда клиент спрашивает о том, какие услуги доступны, "
        "что можно сделать в салоне, или когда нужно показать прайс-лист. "
        "Функция возвращает название услуги, цену и длительность."
    ),
    parameters={
        "type": "object",
        "properties": {},
        "required": []
    }
)


# Определение инструмента для поиска мастеров по услуге
get_masters_for_service_declaration = FunctionDeclaration(
    name="get_masters_for_service",
    description=(
        "Находит мастеров, которые выполняют конкретную услугу. "
        "Используй эту функцию, когда клиент уже определился с услугой и хочет узнать, "
        "какие мастера могут её выполнить. Например, если клиент сказал 'Я хочу женскую стрижку' "
        "или 'Покажи мастеров для маникюра'. Функция принимает точное название услуги."
    ),
    parameters={
        "type": "object",
        "properties": {
            "service_name": {
                "type": "string",
                "description": (
                    "Точное название услуги, для которой нужно найти мастеров. "
                    "Например: 'Женская стрижка', 'Мужская стрижка', 'Маникюр', 'Окрашивание волос'."
                )
            }
        },
        "required": ["service_name"]
    }
)


# Определение инструмента для получения свободных слотов
get_available_slots_declaration = FunctionDeclaration(
    name="get_available_slots",
    description=(
        "Получает список всех свободных временных интервалов для конкретной услуги на указанную дату. "
        "Функция возвращает СЫРЫЕ данные в формате интервалов (например, '10:15-13:45, 15:00-17:30'). "
        "Твоя задача — проанализировать эти данные и предложить клиенту наиболее подходящие варианты. "
        "Используй эту функцию, когда клиент хочет узнать доступное время для записи на услугу. "
        "Например: 'Когда можно записаться на женскую стрижку?' или 'Покажи свободное время для маникюра на завтра'."
    ),
    parameters={
        "type": "object",
        "properties": {
            "service_name": {
                "type": "string",
                "description": (
                    "Название услуги, для которой нужно найти свободные интервалы. "
                    "Например: 'Женская стрижка', 'Маникюр', 'Окрашивание волос'. "
                    "Точное название услуги из прайс-листа."
                )
            },
            "date": {
                "type": "string",
                "description": (
                    "Дата в формате YYYY-MM-DD (например, '2025-10-15'). "
                    "Если клиент говорит 'на завтра' или 'на понедельник', "
                    "нужно преобразовать это в конкретную дату."
                )
            }
        },
        "required": ["service_name", "date"]
    }
)


# Определение инструмента для создания записи
create_appointment_declaration = FunctionDeclaration(
    name="create_appointment",
    description=(
        "Создает запись в календаре для мастера и услуги. "
        "Используй эту функцию, когда пользователь подтвердил время и готов записаться на услугу. "
        "Функция автоматически вычисляет время окончания на основе длительности услуги и создает событие в календаре."
    ),
    parameters={
        "type": "object",
        "properties": {
            "master_name": {
                "type": "string",
                "description": (
                    "Имя мастера, к которому записывается клиент. "
                    "Например: 'Анна', 'Мария', 'Елена'. "
                    "Должно точно соответствовать имени мастера из базы данных."
                )
            },
            "service_name": {
                "type": "string",
                "description": (
                    "Название услуги, на которую записывается клиент. "
                    "Например: 'Женская стрижка', 'Маникюр', 'Окрашивание волос'. "
                    "Должно точно соответствовать названию услуги из прайс-листа."
                )
            },
            "date": {
                "type": "string",
                "description": (
                    "Дата записи в формате YYYY-MM-DD (например, '2025-10-15'). "
                    "Если клиент говорит 'на завтра' или 'на понедельник', "
                    "нужно преобразовать это в конкретную дату."
                )
            },
            "time": {
                "type": "string",
                "description": (
                    "Время записи в формате HH:MM (например, '14:30', '10:00'). "
                    "Время должно быть в 24-часовом формате."
                )
            }
        },
        "required": ["master_name", "service_name", "date", "time"]
    }
)


# Создаем Tool объект, содержащий все наши функции
salon_tools = Tool(
    function_declarations=[
        get_all_services_declaration,
        get_masters_for_service_declaration,
        get_available_slots_declaration,
        create_appointment_declaration
    ]
)

